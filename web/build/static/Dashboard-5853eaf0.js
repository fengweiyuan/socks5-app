import{i as xe,t as Ee,u as Oe,a as Ce,b as Le,c as Se,d as Te,e as Be,f as Ae}from"./install-39925882.js";import{d as ge,F as $,G as P,H as Re,p as B,I as Me,J as q,K as _e,L as be,M as je,N as ue,O as De,P as Ue,i as A,r as G,Q as Fe,c as He,e as r,w as d,R as fe,f as S,o as ke,g as o,t as x,k as K,l as Ne,S as Ie,T as We,U as $e}from"./index-99ea873f.js";import{_ as Pe}from"./_plugin-vue_export-helper-c27b6911.js";var ee=null;function qe(e){return ee||(ee=(window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||function(t){return setTimeout(t,16)}).bind(window)),ee(e)}var te=null;function Ge(e){te||(te=(window.cancelAnimationFrame||window.webkitCancelAnimationFrame||window.mozCancelAnimationFrame||function(t){clearTimeout(t)}).bind(window)),te(e)}function Ke(e){var t=document.createElement("style");return t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e)),(document.querySelector("head")||document.body).appendChild(t),t}function V(e,t){t===void 0&&(t={});var n=document.createElement(e);return Object.keys(t).forEach(function(i){n[i]=t[i]}),n}function me(e,t,n){var i=window.getComputedStyle(e,n||null)||{display:"none"};return i[t]}function ne(e){if(!document.documentElement.contains(e))return{detached:!0,rendered:!1};for(var t=e;t!==document;){if(me(t,"display")==="none")return{detached:!1,rendered:!1};t=t.parentNode}return{detached:!1,rendered:!0}}var Ve='.resize-triggers{visibility:hidden;opacity:0;pointer-events:none}.resize-contract-trigger,.resize-contract-trigger:before,.resize-expand-trigger,.resize-triggers{content:"";position:absolute;top:0;left:0;height:100%;width:100%;overflow:hidden}.resize-contract-trigger,.resize-expand-trigger{background:#eee;overflow:auto}.resize-contract-trigger:before{width:200%;height:200%}',se=0,Q=null;function Je(e,t){e.__resize_mutation_handler__||(e.__resize_mutation_handler__=Xe.bind(e));var n=e.__resize_listeners__;if(!n){if(e.__resize_listeners__=[],window.ResizeObserver){var i=e.offsetWidth,l=e.offsetHeight,s=new ResizeObserver(function(){!e.__resize_observer_triggered__&&(e.__resize_observer_triggered__=!0,e.offsetWidth===i&&e.offsetHeight===l)||Z(e)}),f=ne(e),y=f.detached,p=f.rendered;e.__resize_observer_triggered__=y===!1&&p===!1,e.__resize_observer__=s,s.observe(e)}else if(e.attachEvent&&e.addEventListener)e.__resize_legacy_resize_handler__=function(){Z(e)},e.attachEvent("onresize",e.__resize_legacy_resize_handler__),document.addEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);else if(se||(Q=Ke(Ve)),Ye(e),e.__resize_rendered__=ne(e).rendered,window.MutationObserver){var u=new MutationObserver(e.__resize_mutation_handler__);u.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0}),e.__resize_mutation_observer__=u}}e.__resize_listeners__.push(t),se++}function Qe(e,t){var n=e.__resize_listeners__;if(n){if(t&&n.splice(n.indexOf(t),1),!n.length||!t){if(e.detachEvent&&e.removeEventListener){e.detachEvent("onresize",e.__resize_legacy_resize_handler__),document.removeEventListener("DOMSubtreeModified",e.__resize_mutation_handler__);return}e.__resize_observer__?(e.__resize_observer__.unobserve(e),e.__resize_observer__.disconnect(),e.__resize_observer__=null):(e.__resize_mutation_observer__&&(e.__resize_mutation_observer__.disconnect(),e.__resize_mutation_observer__=null),e.removeEventListener("scroll",ae),e.removeChild(e.__resize_triggers__.triggers),e.__resize_triggers__=null),e.__resize_listeners__=null}!--se&&Q&&Q.parentNode.removeChild(Q)}}function Ze(e){var t=e.__resize_last__,n=t.width,i=t.height,l=e.offsetWidth,s=e.offsetHeight;return l!==n||s!==i?{width:l,height:s}:null}function Xe(){var e=ne(this),t=e.rendered,n=e.detached;t!==this.__resize_rendered__&&(!n&&this.__resize_triggers__&&(re(this),this.addEventListener("scroll",ae,!0)),this.__resize_rendered__=t,Z(this))}function ae(){var e=this;re(this),this.__resize_raf__&&Ge(this.__resize_raf__),this.__resize_raf__=qe(function(){var t=Ze(e);t&&(e.__resize_last__=t,Z(e))})}function Z(e){!e||!e.__resize_listeners__||e.__resize_listeners__.forEach(function(t){t.call(e,e)})}function Ye(e){var t=me(e,"position");(!t||t==="static")&&(e.style.position="relative"),e.__resize_old_position__=t,e.__resize_last__={};var n=V("div",{className:"resize-triggers"}),i=V("div",{className:"resize-expand-trigger"}),l=V("div"),s=V("div",{className:"resize-contract-trigger"});i.appendChild(l),n.appendChild(i),n.appendChild(s),e.appendChild(n),e.__resize_triggers__={triggers:n,expand:i,expandChild:l,contract:s},re(e),e.addEventListener("scroll",ae,!0),e.__resize_last__={width:e.offsetWidth,height:e.offsetHeight}}function re(e){var t=e.__resize_triggers__,n=t.expand,i=t.expandChild,l=t.contract,s=l.scrollWidth,f=l.scrollHeight,y=n.offsetWidth,p=n.offsetHeight,u=n.scrollWidth,a=n.scrollHeight;l.scrollLeft=s,l.scrollTop=f,i.style.width=y+1+"px",i.style.height=p+1+"px",n.scrollLeft=u,n.scrollTop=a}var w=function(){return w=Object.assign||function(e){for(var t,n=1,i=arguments.length;n<i;n++)for(var l in t=arguments[n])Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l]);return e},w.apply(this,arguments)};var et=["getWidth","getHeight","getDom","getOption","resize","dispatchAction","convertToPixel","convertFromPixel","containPixel","getDataURL","getConnectedDataURL","appendData","clear","isDisposed","dispose"];function tt(e){return t=Object.create(null),et.forEach(function(n){t[n]=function(i){return function(){for(var l=[],s=0;s<arguments.length;s++)l[s]=arguments[s];if(!e.value)throw new Error("ECharts is not initialized yet.");return e.value[i].apply(e.value,l)}}(n)}),t;var t}var nt={autoresize:[Boolean,Object]},st=/^on[^a-z]/,ve=function(e){return st.test(e)};function J(e,t){var n=Ue(e)?A(e):e;return n&&typeof n=="object"&&"value"in n?n.value||t:n||t}var at="ecLoadingOptions",rt={loading:Boolean,loadingOptions:Object},j=null,ze="x-vue-echarts",he=[],D=[];(function(e,t){if(e&&typeof document<"u"){var n,i=t.prepend===!0?"prepend":"append",l=t.singleTag===!0,s=typeof t.container=="string"?document.querySelector(t.container):document.getElementsByTagName("head")[0];if(l){var f=he.indexOf(s);f===-1&&(f=he.push(s)-1,D[f]={}),n=D[f]&&D[f][i]?D[f][i]:D[f][i]=y()}else n=y();e.charCodeAt(0)===65279&&(e=e.substring(1)),n.styleSheet?n.styleSheet.cssText+=e:n.appendChild(document.createTextNode(e))}function y(){var p=document.createElement("style");if(p.setAttribute("type","text/css"),t.attributes)for(var u=Object.keys(t.attributes),a=0;a<u.length;a++)p.setAttribute(u[a],t.attributes[u[a]]);var z=i==="prepend"?"afterbegin":"beforeend";return s.insertAdjacentElement(z,p),p}})(`x-vue-echarts{display:flex;flex-direction:column;width:100%;height:100%;min-width:0}
.vue-echarts-inner{flex-grow:1;min-width:0;width:auto!important;height:auto!important}
`,{});var it=function(){if(j!=null)return j;if(typeof HTMLElement>"u"||typeof customElements>"u")return j=!1;try{new Function("tag",`class EChartsElement extends HTMLElement {
  __dispose = null;

  disconnectedCallback() {
    if (this.__dispose) {
      this.__dispose();
      this.__dispose = null;
    }
  }
}

if (customElements.get(tag) == null) {
  customElements.define(tag, EChartsElement);
}
`)(ze)}catch{return j=!1}return j=!0}(),ot="ecTheme",lt="ecInitOptions",ct="ecUpdateOptions",pe=/(^&?~?!?)native:/,dt=ge({name:"echarts",props:w(w({option:Object,theme:{type:[Object,String]},initOptions:Object,updateOptions:Object,group:String,manualUpdate:Boolean},nt),rt),emits:{},inheritAttrs:!1,setup:function(e,t){var n=t.attrs,i=$(),l=$(),s=$(),f=$(),y=P(ot,null),p=P(lt,null),u=P(ct,null),a=Re(e),z=a.autoresize,b=a.manualUpdate,E=a.loading,U=a.loadingOptions,O=B(function(){return f.value||e.option||null}),F=B(function(){return e.theme||J(y,{})}),H=B(function(){return e.initOptions||J(p,{})}),C=B(function(){return e.updateOptions||J(u,{})}),ye=B(function(){return function(_){var c={};for(var v in _)ve(v)||(c[v]=_[v]);return c}(n)}),X={},k=Me().proxy.$listeners,N={};function I(_){if(l.value){var c=s.value=xe(l.value,F.value,H.value);e.group&&(c.group=e.group),Object.keys(N).forEach(function(m){var h=N[m];if(h){var g=m.toLowerCase();g.charAt(0)==="~"&&(g=g.substring(1),h.__once__=!0);var R=c;if(g.indexOf("zr:")===0&&(R=c.getZr(),g=g.substring(3)),h.__once__){delete h.__once__;var T=h;h=function(){for(var M=[],L=0;L<arguments.length;L++)M[L]=arguments[L];T.apply(void 0,M),R.off(g,h)}}R.on(g,h)}}),z.value?De(function(){c&&!c.isDisposed()&&c.resize(),v()}):v()}function v(){var m=_||O.value;m&&c.setOption(m,C.value)}}function Y(){s.value&&(s.value.dispose(),s.value=void 0)}k?Object.keys(k).forEach(function(_){pe.test(_)?X[_.replace(pe,"$1")]=k[_]:N[_]=k[_]}):Object.keys(n).filter(function(_){return ve(_)}).forEach(function(_){var c=_.charAt(2).toLowerCase()+_.slice(3);if(c.indexOf("native:")!==0)c.substring(c.length-4)==="Once"&&(c="~".concat(c.substring(0,c.length-4))),N[c]=n[_];else{var v="on".concat(c.charAt(7).toUpperCase()).concat(c.slice(8));X[v]=n[_]}});var W=null;q(b,function(_){typeof W=="function"&&(W(),W=null),_||(W=q(function(){return e.option},function(c,v){c&&(s.value?s.value.setOption(c,w({notMerge:c!==v},C.value)):I())},{deep:!0}))},{immediate:!0}),q([F,H],function(){Y(),I()},{deep:!0}),_e(function(){e.group&&s.value&&(s.value.group=e.group)});var we=tt(s);return function(_,c,v){var m=P(at,{}),h=B(function(){return w(w({},J(m,{})),v==null?void 0:v.value)});_e(function(){var g=_.value;g&&(c.value?g.showLoading(h.value):g.hideLoading())})}(s,E,U),function(_,c,v){var m=null;q([v,_,c],function(h,g,R){var T=h[0],M=h[1],L=h[2];if(T&&M&&L){var ie=L===!0?{}:L,oe=ie.throttle,le=oe===void 0?100:oe,ce=ie.onResize,de=function(){M.resize(),ce==null||ce()};m=le?Ee(de,le):de,Je(T,m)}R(function(){T&&m&&Qe(T,m)})})}(s,z,l),be(function(){I()}),je(function(){it&&i.value?i.value.__dispose=Y:Y()}),w({chart:s,root:i,inner:l,setOption:function(_,c){e.manualUpdate&&(f.value=_),s.value?s.value.setOption(_,c||{}):I(_)},nonEventAttrs:ye,nativeListeners:X},we)},render:function(){var e=w(w({},this.nonEventAttrs),this.nativeListeners);return e.ref="root",e.class=e.class?["echarts"].concat(e.class):"echarts",ue(ze,e,[ue("div",{ref:"inner",class:"vue-echarts-inner"})])}});const _t={class:"dashboard"},ut={class:"stats-content"},ft={class:"stats-icon user-icon"},vt={class:"stats-info"},ht={class:"stats-value"},pt={class:"stats-content"},gt={class:"stats-icon online-icon"},bt={class:"stats-info"},mt={class:"stats-value"},zt={class:"stats-content"},yt={class:"stats-icon connection-icon"},wt={class:"stats-info"},xt={class:"stats-value"},Et={class:"stats-content"},Ot={class:"stats-icon traffic-icon"},Ct={class:"stats-info"},Lt={class:"stats-value"},St={class:"traffic-stats"},Tt={class:"traffic-item"},Bt={class:"traffic-value sent"},At={class:"traffic-item"},Rt={class:"traffic-value received"},Mt={class:"chart-container"},jt=ge({__name:"Dashboard",setup(e){Oe([Ce,Le,Se,Te,Be,Ae]);const t=G({totalBytesSent:0,totalBytesRecv:0,activeConnections:0,totalUsers:0,onlineUsers:0}),n=G([]),i=G(!0);let l=null;const s=u=>{if(u===0)return"0 B";const a=1024,z=["B","KB","MB","GB","TB"],b=Math.floor(Math.log(u)/Math.log(a));return parseFloat((u/Math.pow(a,b)).toFixed(2))+" "+z[b]},f=u=>new Date(u).toLocaleString(),y=G({title:{text:"实时流量监控",left:"center"},tooltip:{trigger:"axis"},legend:{data:["发送流量","接收流量"],top:30},xAxis:{type:"time",boundaryGap:!1},yAxis:{type:"value",name:"流量 (MB)"},series:[{name:"发送流量",type:"line",smooth:!0,data:[]},{name:"接收流量",type:"line",smooth:!0,data:[]}]}),p=async()=>{try{const[u,a]=await Promise.all([fe.get("/traffic"),fe.get("/online")]);t.value=u.stats,n.value=a.online_users||[]}catch(u){console.error("获取仪表盘数据失败:",u)}finally{i.value=!1}};return be(()=>{p(),l=window.setInterval(p,3e4)}),Fe(()=>{l&&clearInterval(l)}),(u,a)=>{const z=S("el-icon"),b=S("el-card"),E=S("el-col"),U=S("el-row"),O=S("el-table-column"),F=S("el-tag"),H=S("el-table");return ke(),He("div",_t,[r(U,{gutter:20,class:"stats-row"},{default:d(()=>[r(E,{xs:24,sm:12,lg:6},{default:d(()=>[r(b,{class:"stats-card"},{default:d(()=>[o("div",ut,[o("div",ft,[r(z,null,{default:d(()=>[r(A(Ne))]),_:1})]),o("div",vt,[o("div",ht,x(t.value.totalUsers),1),a[0]||(a[0]=o("div",{class:"stats-label"},"总用户数",-1))])])]),_:1})]),_:1}),r(E,{xs:24,sm:12,lg:6},{default:d(()=>[r(b,{class:"stats-card"},{default:d(()=>[o("div",pt,[o("div",gt,[r(z,null,{default:d(()=>[r(A(Ie))]),_:1})]),o("div",bt,[o("div",mt,x(t.value.onlineUsers),1),a[1]||(a[1]=o("div",{class:"stats-label"},"在线用户",-1))])])]),_:1})]),_:1}),r(E,{xs:24,sm:12,lg:6},{default:d(()=>[r(b,{class:"stats-card"},{default:d(()=>[o("div",zt,[o("div",yt,[r(z,null,{default:d(()=>[r(A(We))]),_:1})]),o("div",wt,[o("div",xt,x(t.value.activeConnections),1),a[2]||(a[2]=o("div",{class:"stats-label"},"活跃连接",-1))])])]),_:1})]),_:1}),r(E,{xs:24,sm:12,lg:6},{default:d(()=>[r(b,{class:"stats-card"},{default:d(()=>[o("div",Et,[o("div",Ot,[r(z,null,{default:d(()=>[r(A($e))]),_:1})]),o("div",Ct,[o("div",Lt,x(s(t.value.totalBytesSent+t.value.totalBytesRecv)),1),a[3]||(a[3]=o("div",{class:"stats-label"},"总流量",-1))])])]),_:1})]),_:1})]),_:1}),r(U,{gutter:20,class:"chart-row"},{default:d(()=>[r(E,{xs:24,lg:12},{default:d(()=>[r(b,{class:"chart-card"},{header:d(()=>[...a[4]||(a[4]=[o("span",null,"流量统计",-1)])]),default:d(()=>[o("div",St,[o("div",Tt,[a[5]||(a[5]=o("span",{class:"traffic-label"},"发送流量:",-1)),o("span",Bt,x(s(t.value.totalBytesSent)),1)]),o("div",At,[a[6]||(a[6]=o("span",{class:"traffic-label"},"接收流量:",-1)),o("span",Rt,x(s(t.value.totalBytesRecv)),1)])])]),_:1})]),_:1}),r(E,{xs:24,lg:12},{default:d(()=>[r(b,{class:"chart-card"},{header:d(()=>[...a[7]||(a[7]=[o("span",null,"实时流量图表",-1)])]),default:d(()=>[o("div",Mt,[r(A(dt),{option:y.value,style:{height:"200px"}},null,8,["option"])])]),_:1})]),_:1})]),_:1}),r(b,{class:"online-users-card"},{header:d(()=>[...a[8]||(a[8]=[o("span",null,"在线用户",-1)])]),default:d(()=>[r(H,{data:n.value,style:{width:"100%"},loading:i.value,size:"small"},{default:d(()=>[r(O,{prop:"username",label:"用户名"}),r(O,{prop:"clientIP",label:"客户端IP"}),r(O,{prop:"startTime",label:"连接时间"},{default:d(({row:C})=>[K(x(f(C.startTime)),1)]),_:1}),r(O,{prop:"bytesSent",label:"发送流量"},{default:d(({row:C})=>[K(x(s(C.bytesSent)),1)]),_:1}),r(O,{prop:"bytesRecv",label:"接收流量"},{default:d(({row:C})=>[K(x(s(C.bytesRecv)),1)]),_:1}),r(O,{label:"状态"},{default:d(()=>[r(F,{type:"success",size:"small"},{default:d(()=>[...a[9]||(a[9]=[K("在线",-1)])]),_:1})]),_:1})]),_:1},8,["data","loading"])]),_:1})])}}});const Ht=Pe(jt,[["__scopeId","data-v-0804466a"]]);export{Ht as default};
